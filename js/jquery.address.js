$.browser={},$.browser.mozilla=/mozilla/.test(navigator.userAgent.toLowerCase())&&!/webkit/.test(navigator.userAgent.toLowerCase()),$.browser.webkit=/webkit/.test(navigator.userAgent.toLowerCase()),$.browser.safari=/safari/.test(navigator.userAgent.toLowerCase()),$.browser.opera=/opera/.test(navigator.userAgent.toLowerCase()),$.browser.msie=/msie/.test(navigator.userAgent.toLowerCase()),function(t){t.address=function(){var e,r,n=function(e){var r=t.extend(t.Event(e),function(){for(var e={},r=t.address.parameterNames(),n=0,a=r.length;a>n;n++)e[r[n]]=t.address.parameter(r[n]);return{value:t.address.value(),path:t.address.path(),pathNames:t.address.pathNames(),parameterNames:r,parameters:e,queryString:t.address.queryString()}}.call(t.address));return t(t.address).trigger(r),r},a=function(t){return Array.prototype.slice.call(t)},i=function(e,r,n){return t().bind.apply(t(t.address),Array.prototype.slice.call(arguments)),t.address},s=function(e,r){return t().unbind.apply(t(t.address),Array.prototype.slice.call(arguments)),t.address},o=function(){return D.pushState&&O.state!==e},c=function(){return("/"+K.pathname.replace(new RegExp(O.state),"")+K.search+(u()?"#"+u():"")).replace(Q,"/")},u=function(){var t=K.href.indexOf("#");return-1!=t?f(K.href.substr(t+1),T):""},l=function(){return o()?c():u()},d=function(){try{return top.document!==e&&top.document.title!==e?top:window}catch(t){return window}},h=function(){return"javascript"},p=function(t){return t=t.toString(),(O.strict&&"/"!=t.substr(0,1)?"/":"")+t},f=function(t,e){return O.crawlable&&e?(""!==t?"!":"")+t:t.replace(/^\!/,"")},g=function(t,e){return parseInt(t.css(e),10)},v=function(){if(!X){var t=l(),e=decodeURI(et)!=decodeURI(t);e&&(W&&!G&&O.history&&M(b,50),_old=et,et=t,m(T))}},m=function(t){var e=n(L),r=n(t?j:q);M(w,10),(e.isDefaultPrevented()||r.isDefaultPrevented())&&y()},y=function(){et=_old,o()?D.popState({},"",O.state.replace(/\/$/,"")+(""===et?"/":et)):(X=N,B?O.history?K.hash="#"+f(et,N):K.replace("#"+f(et,N)):et!=l()&&(O.history?K.hash="#"+f(et,N):K.replace("#"+f(et,N))),W&&!G&&O.history&&M(b,50),B?M(function(){X=T},1):X=T)},w=function(){if("null"!==O.tracker&&O.tracker!==S){var r=t.isFunction(O.tracker)?O.tracker:F[O.tracker],n=(K.pathname+K.search+(t.address&&!o()?t.address.value():"")).replace(/\/\//,"/").replace(/^\/$/,"");t.isFunction(r)?r(n):t.isFunction(F.urchinTracker)?F.urchinTracker(n):F.pageTracker!==e&&t.isFunction(F.pageTracker._trackPageview)?F.pageTracker._trackPageview(n):F._gaq!==e&&t.isFunction(F._gaq.push)&&F._gaq.push(["_trackPageview",decodeURI(n)])}},b=function(){var t=h()+":"+T+";document.open();document.writeln('<html><head><title>"+P.title.replace(/\'/g,"\\'")+"</title><script>var "+_+' = "'+encodeURIComponent(l()).replace(/\'/g,"\\'")+(P.domain!=K.hostname?'";document.domain="'+P.domain:"")+"\";</script></head></html>');document.close();";r.contentWindow.location.replace(t)},k=function(){if(H&&-1!=J){var t,e,r=H.substr(J+1).split("&");for(t=0;t<r.length;t++)e=r[t].split("="),/^(autoUpdate|crawlable|history|strict|wrap)$/.test(e[0])&&(O[e[0]]=isNaN(e[1])?/^(true|yes)$/i.test(e[1]):0!==parseInt(e[1],10)),/^(state|tracker)$/.test(e[0])&&(O[e[0]]=e[1]);H=S}_old=et,et=l()},x=function(){if(!Y){Y=N,k();var a=function(){$.call(this),R.call(this)},i=t("body").ajaxComplete(a);if(a(),O.wrap){t("body > *").wrapAll('<div style="padding:'+(g(i,"marginTop")+g(i,"paddingTop"))+"px "+(g(i,"marginRight")+g(i,"paddingRight"))+"px "+(g(i,"marginBottom")+g(i,"paddingBottom"))+"px "+(g(i,"marginLeft")+g(i,"paddingLeft"))+'px;" />').parent().wrap('<div id="'+_+'" style="height:100%;overflow:auto;position:relative;'+(B&&!window.statusbar.visible?"resize:both;":"")+'" />');t("html, body").css({height:"100%",margin:0,padding:0,overflow:"hidden"}),B&&t('<style type="text/css" />').appendTo("head").text("#"+_+"::-webkit-resizer { background-color: #fff; }")}if(W&&!G){var s=P.getElementsByTagName("frameset")[0];r=P.createElement((s?"":"i")+"frame"),r.src=h()+":"+T,s?(s.insertAdjacentElement("beforeEnd",r),s[s.cols?"cols":"rows"]+=",0",r.noResize=N,r.frameBorder=r.frameSpacing=0):(r.style.display="none",r.style.width=r.style.height=0,r.tabIndex=-1,P.body.insertAdjacentElement("afterBegin",r)),M(function(){t(r).on("load",function(){var t=r.contentWindow;_old=et,et=t[_]!==e?t[_]:"",et!=l()&&(m(T),K.hash=f(et,N))}),r.contentWindow[_]===e&&b()},50)}M(function(){n("init"),m(T)},1),o()||(F.addEventListener?F.addEventListener(I,v,T):F.attachEvent&&F.attachEvent("on"+I,v)),"state"in window.history&&t(window).trigger("popstate")}},$=function(){var e,r=t("a"),n=r.length,a=1,i=-1,s='[rel*="address:"]',o=function(){++i!=n&&(e=t(r.get(i)),e.is(s)&&e.address(s),M(o,a))};M(o,a)},E=function(){decodeURI(et)!=decodeURI(l())&&(_old=et,et=l(),m(T))},A=function(){F.removeEventListener?F.removeEventListener(I,v,T):F.detachEvent&&F.detachEvent("on"+I,v)},R=function(){if(O.crawlable){var e=K.pathname.replace(/\/$/,""),r="_escaped_fragment_";-1!=t("body").html().indexOf(r)&&t('a[href]:not([href^=http]), a[href*="'+document.domain+'"]').each(function(){var n=t(this).attr("href").replace(/^http:/,"").replace(new RegExp(e+"/?$"),"");(""===n||-1!=n.indexOf(r))&&t(this).attr("href","#"+encodeURI(decodeURIComponent(n.replace(new RegExp("/(.*)\\?"+r+"=(.*)$"),"!$2"))))})}},S=null,_="jQueryAddress",U="string",I="hashchange",C="init",L="change",j="internalChange",q="externalChange",N=!0,T=!1,O={autoUpdate:N,crawlable:T,history:N,strict:N,wrap:T},z=t.browser,W=!t.support.opacity,B=z.webkit||z.safari,F=d(),P=F.document,D=F.history,K=F.location,M=(setInterval,setTimeout),Q=/\/{2,9}/g,G=(navigator.userAgent,"on"+I in F),H=t("script:last").attr("src"),J=H?H.indexOf("?"):-1,V=P.title,X=T,Y=T,Z=N,tt=T,et=l();if(_old=et,W){var rt=P.onpropertychange;P.onpropertychange=function(){rt&&rt.call(P),P.title!=V&&-1!=P.title.indexOf("#"+l())&&(P.title=V)}}if(D.navigationMode&&(D.navigationMode="compatible"),"complete"==document.readyState)var nt=setInterval(function(){t.address&&(x(),clearInterval(nt))},50);else k(),t(x);return t(window).on("popstate",E).on("unload",A),{bind:function(t,e,r){return i.apply(this,a(arguments))},unbind:function(t,e){return s.apply(this,a(arguments))},init:function(t,e){return i.apply(this,[C].concat(a(arguments)))},change:function(t,e){return i.apply(this,[L].concat(a(arguments)))},internalChange:function(t,e){return i.apply(this,[j].concat(a(arguments)))},externalChange:function(t,e){return i.apply(this,[q].concat(a(arguments)))},baseURL:function(){var t=K.href;return-1!=t.indexOf("#")&&(t=t.substr(0,t.indexOf("#"))),/\/$/.test(t)&&(t=t.substr(0,t.length-1)),t},autoUpdate:function(t){return t!==e?(O.autoUpdate=t,this):O.autoUpdate},crawlable:function(t){return t!==e?(O.crawlable=t,this):O.crawlable},history:function(t){return t!==e?(O.history=t,this):O.history},state:function(t){if(t!==e){O.state=t;var r=c();return O.state!==e&&(D.pushState?"/#/"==r.substr(0,3)&&K.replace(O.state.replace(/^\/$/,"")+r.substr(2)):"/"!=r&&r.replace(/^\/#/,"")!=u()&&M(function(){K.replace(O.state.replace(/^\/$/,"")+"/#"+r)},1)),this}return O.state},strict:function(t){return t!==e?(O.strict=t,this):O.strict},tracker:function(t){return t!==e?(O.tracker=t,this):O.tracker},wrap:function(t){return t!==e?(O.wrap=t,this):O.wrap},update:function(){return tt=N,this.value(et),tt=T,this},title:function(t){return t!==e?(M(function(){V=P.title=t,Z&&r&&r.contentWindow&&r.contentWindow.document&&(r.contentWindow.document.title=t,Z=T)},50),this):P.title},value:function(t){if(t!==e){if(t=p(t),"/"==t&&(t=""),et==t&&!tt)return;return _old=et,et=t,(O.autoUpdate||tt)&&(m(N),o()?D[O.history?"pushState":"replaceState"]({},"",O.state.replace(/\/$/,"")+(""===et?"/":et)):(X=N,B?O.history?K.hash="#"+f(et,N):K.replace("#"+f(et,N)):et!=l()&&(O.history?K.hash="#"+f(et,N):K.replace("#"+f(et,N))),W&&!G&&O.history&&M(b,50),B?M(function(){X=T},1):X=T)),this}return p(et)},path:function(t){if(t!==e){var r=this.queryString(),n=this.hash();return this.value(t+(r?"?"+r:"")+(n?"#"+n:"")),this}return p(et).split("#")[0].split("?")[0]},pathNames:function(){var t=this.path(),e=t.replace(Q,"/").split("/");return("/"==t.substr(0,1)||0===t.length)&&e.splice(0,1),"/"==t.substr(t.length-1,1)&&e.splice(e.length-1,1),e},queryString:function(t){if(t!==e){var r=this.hash();return this.value(this.path()+(t?"?"+t:"")+(r?"#"+r:"")),this}var n=et.split("?");return n.slice(1,n.length).join("?").split("#")[0]},parameter:function(r,n,a){var i,s;if(n!==e){var o=this.parameterNames();for(s=[],n=n===e||n===S?"":n.toString(),i=0;i<o.length;i++){var c=o[i],u=this.parameter(c);typeof u==U&&(u=[u]),c==r&&(u=n===S||""===n?[]:a?u.concat([n]):[n]);for(var l=0;l<u.length;l++)s.push(c+"="+u[l])}return-1==t.inArray(r,o)&&n!==S&&""!==n&&s.push(r+"="+n),this.queryString(s.join("&")),this}if(n=this.queryString()){var d=[];for(s=n.split("&"),i=0;i<s.length;i++){var h=s[i].split("=");h[0]==r&&d.push(h.slice(1).join("="))}if(0!==d.length)return 1!=d.length?d:d[0]}},parameterNames:function(){var e=this.queryString(),r=[];if(e&&-1!=e.indexOf("="))for(var n=e.split("&"),a=0;a<n.length;a++){var i=n[a].split("=")[0];-1==t.inArray(i,r)&&r.push(i)}return r},hash:function(t){if(t!==e)return this.value(et.split("#")[0]+(t?"#"+t:"")),this;var r=et.split("#");return r.slice(1,r.length).join("#")}}}(),t.fn.address=function(e){var r;if("string"==typeof e&&(r=e,e=void 0),!t(this).attr("address")){var n=function(r){if(r.shiftKey||r.ctrlKey||r.metaKey||2==r.which)return!0;if(t(this).is("a")){r.preventDefault();var n=e?e.call(this):/address:/.test(t(this).attr("rel"))?t(this).attr("rel").split("address:")[1].split(" ")[0]:void 0===t.address.state()||/^\/?$/.test(t.address.state())?t(this).attr("href").replace(/^(#\!?|\.)/,""):t(this).attr("href").replace(new RegExp("^(.*"+t.address.state()+"|\\.)"),"");t.address.value(n)}};t(document).on("click",r?r:this,n).on("submit",r?r:this,function(r){if(t(this).is("form")){r.preventDefault();var n=t(this).attr("action"),a=e?e.call(this):(-1!=n.indexOf("?")?n.replace(/&$/,""):n+"?")+t(this).serialize();t.address.value(a)}}).attr("address",!0)}return this}}(jQuery);